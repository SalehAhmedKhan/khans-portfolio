<!-- File: hub-page.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading…</title>

    <!-- FAVICON (STATIC: NOT FROM JSON) -->
    <link rel="icon" type="image/png" href="../../favicon1.png">

    <style>
        /* ===== Dark Technical Gradient Background (VARIES BY JSON TITLE) ===== */
        body {
            margin: 0;
            font-family: Arial, Helvetica, sans-serif;
            color: #f5f5f5;

            --g1: rgba(80,120,255,0.12);
            --g2: rgba(0,200,180,0.08);
            --bgA: #0b0f1a;
            --bgB: #111827;
            --bgC: #0a0e17;

            background:
                radial-gradient(circle at 20% 20%, var(--g1), transparent 40%),
                radial-gradient(circle at 80% 30%, var(--g2), transparent 45%),
                linear-gradient(135deg, var(--bgA), var(--bgB) 60%, var(--bgC));
            background-attachment: fixed;
        }

        header { padding: 2rem 1.5rem; text-align: center; }
        header h1 { margin: 0 0 0.5rem 0; font-size: 2rem; font-weight: 600; }
        header p { margin: 0; opacity: 0.9; }

        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1.5rem 2rem;
        }

        .section {
            background: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            backdrop-filter: blur(6px);
            color: #f5f5f5;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
        }

        .section-intro {
            margin: 0.35rem 0 0.9rem;
            font-size: 0.95rem;
            opacity: 0.95;
        }

        .section-quote {
            margin: 0.5rem 0 0.25rem;
            font-style: italic;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .scroll-row {
            display: flex;
            overflow-x: auto;
            gap: 1rem;
            padding-bottom: 0.5rem;
        }

        .grid-row {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        }

        @media (min-width: 900px) {
            .grid-row {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        .hub-card {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 1rem;
            backdrop-filter: blur(4px);
            color: #fff;
            box-sizing: border-box;
            display: block;
            text-decoration: none;
            transition: transform 0.12s ease, border-color 0.12s ease, background 0.12s ease;
        }

        .hub-card:hover {
            transform: translateY(-2px);
            border-color: rgba(159, 201, 255, 0.42);
            background: rgba(255, 255, 255, 0.18);
        }

        .scroll-row .hub-card { min-width: 240px; }

        .hub-card-title { margin: 0 0 0.4rem; font-weight: 600; }
        .hub-card-desc { margin: 0; font-size: 0.85rem; opacity: 0.85; }

        .group-card { min-width: 260px; }
        .group-affiliation { margin: 0 0 0.35rem; font-size: 0.8rem; opacity: 0.92; font-weight: 600; }
        .group-description { margin: 0; font-size: 0.85rem; opacity: 0.85; }

        .back-wrap {
            display: flex;
            justify-content: center;
            margin-top: 1.25rem;
        }

        a.back-btn {
            display: inline-block;
            text-decoration: none;
            font-weight: 700;
            color: #eaf2ff;
            background: rgba(159, 201, 255, 0.16);
            border: 1px solid rgba(159, 201, 255, 0.28);
            padding: 0.8rem 1.2rem;
            border-radius: 12px;
            backdrop-filter: blur(8px);
            box-shadow: 0 10px 28px rgba(0,0,0,0.35);
        }
    </style>
</head>
<body>

<header>
    <h1 id="page-title">Loading…</h1>
    <p id="page-subtitle">Loading…</p>
</header>

<div class="container" id="content-root">
    <div class="back-wrap">
        <a class="back-btn" id="back-link" href="../../index.html">Back to my Portfolio</a>
    </div>
</div>

<script>
const STATIC_QUOTE_TEXT = "“If I am walking with two other men, each of them will serve as my teacher.”";
const STATIC_QUOTE_AUTHOR = "Confucius";

function el(tag, className, text) {
    const node = document.createElement(tag);
    if (className) node.className = className;
    if (text !== undefined && text !== null) node.textContent = text;
    return node;
}

/* UPDATED: allow new-tab control */
function makeCard(card, openNewTab) {
    const isGroup = !!card.affiliation;
    const href = card.href || "#";

    const a = document.createElement("a");
    a.className = `hub-card${isGroup ? " group-card" : ""}`;
    a.href = href;

    if (openNewTab) {
        a.target = "_blank";
        a.rel = "noopener";
    }

    a.appendChild(el("div", "hub-card-title", card.title || ""));

    if (isGroup) {
        if (card.affiliation) a.appendChild(el("p", "group-affiliation", card.affiliation));
        if (card.desc) a.appendChild(el("p", "group-description", card.desc));
    } else {
        if (card.desc) a.appendChild(el("p", "hub-card-desc", card.desc));
    }

    return a;
}

function renderSection(section, index) {
    const wrap = el("div", "section");

    if (section.title) wrap.appendChild(el("h2", "", section.title));

    if (index === 2) {
        const q = el("p", "section-quote");
        q.textContent = `${STATIC_QUOTE_TEXT} — `;
        const span = document.createElement("span");
        span.style.fontStyle = "normal";
        span.textContent = STATIC_QUOTE_AUTHOR;
        q.appendChild(span);
        wrap.appendChild(q);
        wrap.appendChild(document.createElement("br"));
    }

    if (section.intro) wrap.appendChild(el("p", "section-intro", section.intro));

    const row = el("div", index === 0 ? "grid-row" : "scroll-row");

    /* UPDATED: sections 1 and 2 open in new tab */
    const openNewTab = (index === 1 || index === 2);

    (section.cards || []).forEach(card =>
        row.appendChild(makeCard(card, openNewTab))
    );

    wrap.appendChild(row);
    return wrap;
}

async function loadHubPage() {
    const root = document.getElementById("content-root");
    const h1 = document.getElementById("page-title");
    const subtitle = document.getElementById("page-subtitle");
    const backLink = document.getElementById("back-link");

    const res = await fetch("hub-page.json", { cache: "no-store" });
    const data = await res.json();

    document.title = data.title || "Research Hub";
    h1.textContent = data.title || "Research Hub";
    subtitle.textContent = data.subtitle || "";

    const backWrap = backLink.closest(".back-wrap");
    root.innerHTML = "";
    root.appendChild(backWrap);

    (data.sections || []).forEach((section, i) => {
        const node = renderSection(section, i);
        root.insertBefore(node, backWrap);
    });
}

document.addEventListener("DOMContentLoaded", loadHubPage);
</script>

</body>
</html>
