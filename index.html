<!-- File: index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khan's Portfolio</title>

    <link rel="icon" type="image/png" href="favicon1.png">

    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            color: #e5e7eb;

            /* Background graphic + dark blue tint */
            background:
                linear-gradient(rgba(15,23,42,0.85), rgba(15,23,42,0.85)),
                url("ChatGPT%20Image%20Dec%208,%202025,%2007_22_56%20PM.png");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* ===== Central container (squeezed layout) ===== */
        .container {
            max-width: 1024px;
            margin: 1.2rem auto 0.4rem;
            padding: 0 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.9rem;
        }

        /* ===== Shared glass style ===== */
        .glass {
            background: rgba(15,23,42,0.78);
            border-radius: 18px;
            border: 1px solid rgba(148,163,184,0.45);
            box-shadow:
                0 24px 60px rgba(15,23,42,0.8),
                0 0 0 1px rgba(15,23,42,0.4) inset;
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            padding: 1.3rem 1.6rem;
        }

        /* ===== Hero card ===== */
        .hero-card {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 1.4rem;
        }

        .hero-text {
            flex: 1.6;
        }

        /* ✅ Uniform hero typography (only typography change in hero) */
        .hero-title {
            font-size: 2.15rem;
            font-weight: 700;
            letter-spacing: -0.3px;
            margin: 0 0 0.35rem;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 0 0 0.6rem;
            color: #f1f5f9;
        }

        .hero-affiliation {
            margin: 0 0 0.85rem;
            font-size: 0.92rem;
            font-weight: 400;
            line-height: 1.35;
            color: #dbeafe;
        }

        .hero-tagline {
            margin: 0.25rem 0;
            font-size: 0.92rem;
            font-weight: 400;
            line-height: 1.45;
            color: #cbd5f5;
        }

        .hero-contact {
            margin: 0.75rem 0 0;
            font-size: 0.88rem;
            font-weight: 400;
            line-height: 1.45;
            color: #cbd5f5;
        }

        .hero-contact a {
            color: #93c5fd;
            text-decoration: none;
        }

        .hero-contact a:hover {
            text-decoration: underline;
        }

        .hero-socials {
            margin: 0.55rem 0 0;
            font-size: 0.88rem;
            font-weight: 400;
            color: #cbd5f5;
        }

        .hero-socials a {
            color: #93c5fd;
            text-decoration: none;
        }

        .hero-socials a:hover {
            text-decoration: underline;
        }

        .hero-image-wrapper {
            flex: 0 0 auto;
            display: flex;
            justify-content: flex-end;
        }

        /* Portrait frame with diagonal edge, fixed size */
        .hero-image {
            width: 240px;
            height: 360px;
            background-image: url("362913277_1456595465179872_8041301197273694670_n%20(1)%20-%20Copy.jpg");
            background-size: cover;
            background-position: center;
            background-color: #020617;
            border-radius: 16px;
            overflow: hidden;
            margin-left: auto;
            clip-path: polygon(18% 0, 100% 0, 100% 100%, 0 100%);
        }

        /* ===== Tabbed cards section ===== */
        .tabs {
            display: flex;
            flex-direction: column;
        }

        /* Justified tab labels */
        .tab-labels {
            display: flex;
            justify-content: space-between; /* spreads buttons evenly */
            gap: 0.6rem;
            margin-bottom: 0.7rem;
            width: 100%;
            flex-wrap: wrap;
        }

        .tab-label {
            flex: 1;
            text-align: center;
            white-space: nowrap;

            padding: 0.35rem 0.8rem;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.5);
            font-size: 0.88rem;
            cursor: pointer;
            background: rgba(15,23,42,0.9);
            color: #e5e7eb;
        }

        .tab-label:hover {
            background: rgba(37,99,235,0.4);
        }

        .tab-contents {
            background: rgba(15,23,42,0.9);
            border-radius: 14px;
            border: 1px solid rgba(148,163,184,0.35);
            padding: 0.9rem 1rem;
            box-shadow: 0 10px 25px rgba(15,23,42,0.6);
            font-size: 0.84rem;
            position: relative;
            min-height: 145px; /* keeps box from jumping in height */
        }

        /* ✅ Force JSON + non-JSON panels to match typography exactly */
        .tab-panel {
            display: none;
            opacity: 0;
            font-family: inherit;
            font-size: 0.84rem;
            line-height: 1.4;
        }

        .tab-panel h3 {
            margin: 0 0 0.3rem;
            font-size: 1rem;
        }

        .tab-panel p {
            margin: 0 0 0.4rem;
            color: #d1d5db;
        }

        .tab-panel ul {
            margin: 0.2rem 0 0;
            padding-left: 1.1rem;
            color: #cbd5f5;
            font-size: 0.82rem;
        }

        /* ===== WRAP FIX for ALL JSON-loaded tabs (scoped) ===== */
        #content-pubs, #content-edu, #content-prof, #content-awards, #content-tools,
        #content-pubs *, #content-edu *, #content-prof *, #content-awards *, #content-tools *{
            max-width: 100%;
            overflow-wrap: anywhere;
            word-break: break-word;
        }

        .pub-desc{
            white-space: pre-line;
        }
        /* ===== END WRAP FIX ===== */

        /* ===== Publications tab layout (scoped) ===== */
        .pub-intro{
            margin: 0 0 0.6rem;
            color: #d1d5db;
        }

        .pub-section{
            margin-top: 0.9rem;
        }

        .pub-section-title{
            margin: 0 0 0.55rem;
            font-size: 0.95rem;
            font-weight: 700;
            color: #f1f5f9;
        }

        .pub-entry{
            margin: 0;
        }

        .pub-title{
            font-weight: 700;
            color: #e5e7eb;
            margin: 0 0 0.22rem;
        }

        .pub-authors{
            margin: 0 0 0.18rem;
            color: #cbd5f5;
            font-size: 0.83rem;
            line-height: 1.4;
        }

        .pub-venue{
            margin: 0 0 0.28rem;
            color: #dbeafe;
            font-size: 0.82rem;
            font-weight: 600;
            line-height: 1.4;
        }

        .pub-desc{
            margin: 0 0 0.3rem;
            color: #d1d5db;
            font-size: 0.83rem;
            line-height: 1.45;
        }

        .pub-doi a{
            color: #93c5fd;
            text-decoration: none;
            font-size: 0.83rem;
        }
        .pub-doi a:hover{
            text-decoration: underline;
        }

        .pub-divider{
            border: none;
            border-top: 1px solid rgba(148,163,184,0.35);
            margin: 0.9rem 0;
            width: 100%;
        }

        /* ===== Education tab layout (scoped) ===== */
        .edu-entry{
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            align-items: flex-start;
        }

        .edu-left{
            flex: 1;
            min-width: 0;
        }

        .edu-title{
            font-weight: 700;
            color: #e5e7eb;
            margin: 0 0 0.18rem;
        }

        .edu-lines{
            color: #cbd5f5;
            line-height: 1.4;
            font-size: 0.83rem;
        }

        .edu-right{
            flex: 0 0 auto;
            text-align: right;
            max-width: 46%;
        }

        .edu-dates{
            font-size: 0.82rem;
            color: #dbeafe;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .edu-divider{
            border: none;
            border-top: 1px solid rgba(148,163,184,0.35);
            margin: 0.9rem 0;
            width: 100%;
        }

        @media (max-width: 640px){
            .edu-entry{
                flex-direction: column;
                gap: 0.35rem;
            }
            .edu-right{
                text-align: left;
                max-width: 100%;
            }
            .edu-dates{
                white-space: normal;
            }
        }

        /* ===== Experiences tab layout (scoped) ===== */
        .exp-section{
            margin-top: 0.9rem;
        }

        .exp-section-title{
            margin: 0 0 0.55rem;
            font-size: 0.95rem;
            font-weight: 700;
            color: #f1f5f9;
        }

        .exp-subtitle{
            margin: 0.55rem 0 0.2rem;
            font-size: 0.86rem;
            font-weight: 700;
            color: #93c5fd;
        }

        .exp-entry{
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            align-items: flex-start;
        }

        .exp-left{
            flex: 1;
            min-width: 0;
        }

        .exp-role{
            font-weight: 700;
            color: #e5e7eb;
            margin: 0 0 0.18rem;
        }

        .exp-org{
            color: #93c5fd;
            font-size: 0.83rem;
            margin: 0 0 0.25rem;
        }

        .exp-desc{
            color: #cbd5f5;
            font-size: 0.83rem;
            line-height: 1.4;
        }

        .exp-right{
            flex: 0 0 auto;
            text-align: right;
            max-width: 46%;
        }

        .exp-dates{
            font-size: 0.82rem;
            color: #dbeafe;
            font-weight: 600;
            white-space: nowrap;
        }

        .exp-tools{
            margin: 0.2rem 0 0.35rem;
            padding-left: 1.1rem;
            color: #cbd5f5;
            font-size: 0.82rem;
        }

        .exp-divider{
            border: none;
            border-top: 1px solid rgba(148,163,184,0.35);
            margin: 0.9rem 0;
            width: 100%;
        }

        @media (max-width: 640px){
            .exp-entry{
                flex-direction: column;
                gap: 0.35rem;
            }
            .exp-right{
                text-align: left;
                max-width: 100%;
            }
            .exp-dates{
                white-space: normal;
            }
        }

        /* ===== Awards tab layout (scoped) ===== */
        .awd-intro{
            margin: 0 0 0.6rem;
            color: #d1d5db;
        }

        .awd-section{
            margin-top: 0.9rem;
        }

        .awd-section-title{
            margin: 0 0 0.55rem;
            font-size: 0.95rem;
            font-weight: 700;
            color: #f1f5f9;
        }

        .awd-entry{
            margin: 0;
        }

        .awd-title{
            font-weight: 700;
            color: #e5e7eb;
            margin: 0 0 0.22rem;
        }

        .awd-desc{
            margin: 0 0 0.3rem;
            color: #cbd5f5;
            font-size: 0.83rem;
            line-height: 1.45;
        }

        .awd-divider{
            border: none;
            border-top: 1px solid rgba(148,163,184,0.35);
            margin: 0.9rem 0;
            width: 100%;
        }

        /* ===== References tab layout (scoped) ===== */
        .ref-intro{
            margin: 0 0 0.7rem;
            color: #d1d5db;
        }

        .ref-section{
            margin-top: 0.9rem;
        }

        .ref-section-title{
            margin: 0 0 0.55rem;
            font-size: 0.95rem;
            font-weight: 700;
            color: #f1f5f9;
        }

        .ref-entry{
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            align-items: flex-start;
        }

        .ref-left{
            flex: 1;
            min-width: 0;
        }

        .ref-name{
            font-weight: 700;
            color: #e5e7eb;
            margin: 0 0 0.25rem;
        }

        .ref-lines{
            color: #cbd5f5;
            line-height: 1.4;
            font-size: 0.83rem;
        }

        .ref-lines a{
            color: #93c5fd;
            text-decoration: none;
        }
        .ref-lines a:hover{
            text-decoration: underline;
        }

        .ref-right{
            flex: 0 0 auto;
            text-align: right;
            max-width: 44%;
        }

        .ref-relation{
            font-size: 0.82rem;
            color: #dbeafe;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .ref-divider{
            border: none;
            border-top: 1px solid rgba(148,163,184,0.35);
            margin: 0.9rem 0;
            width: 100%;
        }

        @media (max-width: 640px){
            .ref-entry{
                flex-direction: column;
                gap: 0.35rem;
            }
            .ref-right{
                text-align: left;
                max-width: 100%;
            }
            .ref-relation{
                white-space: normal;
            }
        }

        .btn {
            margin-top: 0.45rem;
            display: inline-block;
            padding: 0.4rem 0.85rem;
            background: #2563eb;
            color: #ffffff;
            text-decoration: none;
            border-radius: 999px;
            font-size: 0.8rem;
        }

        .btn:hover {
            background: #1d4ed8;
        }

        .btn-muted {
            background: rgba(148,163,184,0.18);
            border: 1px solid rgba(148,163,184,0.35);
        }

        .btn-muted:hover {
            background: rgba(148,163,184,0.28);
        }

        .btn-row{
            display: flex;
            gap: 0.55rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn-faith{
            background: #064e3b; /* deep dark green */
        }
        .btn-faith:hover{
            background: #065f46;
        }

        /* Hide the radio buttons */
        .tabs input[type="radio"] {
            display: none;
        }

        /* Animations */
        @keyframes fadeSlideLeft {
            from { opacity: 0; transform: translateX(-12px); }
            to   { opacity: 1; transform: translateX(0); }
        }

        @keyframes fadeSlideRight {
            from { opacity: 0; transform: translateX(12px); }
            to   { opacity: 1; transform: translateX(0); }
        }

        /* Left four tabs slide from left */
        #tab-pubs:checked      ~ .tab-contents #content-pubs,
        #tab-edu:checked       ~ .tab-contents #content-edu,
        #tab-prof:checked      ~ .tab-contents #content-prof,
        #tab-awards:checked    ~ .tab-contents #content-awards {
            display: block;
            opacity: 1;
            animation: fadeSlideLeft 0.25s ease forwards;
        }

        /* Right three tabs slide from right */
        #tab-tools:checked     ~ .tab-contents #content-tools,
        #tab-research:checked  ~ .tab-contents #content-research,
        #tab-hobbies:checked   ~ .tab-contents #content-hobbies {
            display: block;
            opacity: 1;
            animation: fadeSlideRight 0.25s ease forwards;
        }

        /* Active tab label styling */
        #tab-pubs:checked      ~ .tab-labels label[for="tab-pubs"],
        #tab-edu:checked       ~ .tab-labels label[for="tab-edu"],
        #tab-prof:checked      ~ .tab-labels label[for="tab-prof"],
        #tab-awards:checked    ~ .tab-labels label[for="tab-awards"],
        #tab-tools:checked     ~ .tab-labels label[for="tab-tools"],
        #tab-research:checked  ~ .tab-labels label[for="tab-research"],
        #tab-hobbies:checked   ~ .tab-labels label[for="tab-hobbies"] {
            background: #2563eb;
            border-color: #60a5fa;
        }

        /* ===== Credit line under cards ===== */
        .page-credit {
            text-align: center;
            margin-top: 0.3rem;
            margin-bottom: 0.2rem;
            font-size: 0.78rem;
            color: #cbd5f5;
            text-shadow: 0 1px 2px rgba(15,23,42,0.9);
        }

        footer {
            display: none;
        }

        /* ✅ Mobile/narrow screens:
              - image on top
              - diagonal preserved
              - face cropping fixed */
        @media (max-width: 900px) {
            html, body {
                overflow: auto;
            }

            .hero-card {
                flex-direction: column;
                align-items: stretch;
            }

            .hero-image-wrapper {
                order: -1;
                width: 100%;
                justify-content: flex-start;
                margin-bottom: 0.9rem;
            }

            .hero-image {
                width: 100%;
                max-width: none;
                height: 340px;

                /* keep diagonal style */
                clip-path: polygon(12% 0, 100% 0, 100% 100%, 0 100%);

                /* ✅ keep face visible */
                background-position: center 18%;
            }

            .tab-labels {
                justify-content: center;
            }
            .tab-label {
                flex: unset;
            }
        }

        @media (max-width: 640px) {
            .tab-labels {
                gap: 0.3rem;
            }
        }

        /* Hero actions */
        .hero-actions {
            margin-top: 0.7rem;
        }
        .hero-actions p {
            margin: 0.15rem 0;
            font-size: 0.9rem;
            color: #cbd5f5;
            line-height: 1.4;
        }
    </style>
</head>

<body>
<div class="page">

    <main class="container">

        <!-- HERO GLASS PANEL -->
        <section class="glass hero-card">
            <div class="hero-text">
                <h1 class="hero-title">Welcome to Khan's Portfolio</h1>
                <p class="hero-subtitle">Hi, I’m Saleh Ahmed Khan.</p>

                <p class="hero-affiliation">
                    Graduate Research Assistant<br>
                    Department of Electrical and Computer Engineering<br>
                    University of Massachusetts Lowell
                </p>

                <p class="hero-tagline">
                    Researcher in ultrawide-bandgap semiconductors and power device engineering.
                </p>
                <p class="hero-tagline">
                    Exploring material growth, breakdown physics, and next-generation electronics.
                </p>

                <p class="hero-contact">
                    Personal email:
                    <a href="mailto:salehahmedkhan1998@gmail.com">salehahmedkhan1998@gmail.com</a><br>
                    Academic email:
                    <a href="mailto:salehahmed_khan@uml.edu">salehahmed_khan@uml.edu</a>
                </p>

                <p class="hero-socials">
                    Socials:
                    <a href="https://www.linkedin.com/in/saleh-ahmed-khan-7219a5216" target="_blank">LinkedIn</a> ·
                    <a href="https://www.researchgate.net/profile/Saleh-Ahmed-Khan" target="_blank">ResearchGate</a> ·
                    <a href="https://www.youtube.com/@vault119" target="_blank">YouTube</a>
                </p>

                <div class="hero-actions">
                    <p>Explore my professional resume and academic profiles</p>

                    <div class="btn-row">
                        <a class="btn" href="CV.pdf" target="_blank" rel="noopener">View Resume</a>
                        <a class="btn btn-muted" href="https://scholar.google.com/citations?user=Jh4FxU4AAAAJ&hl=en" target="_blank" rel="noopener">Google Scholar</a>
                        <a class="btn btn-muted" href="https://github.com/SalehAhmedKhan?tab=repositories" target="_blank" rel="noopener">GitHub</a>
                    </div>

                    <p style="margin: 0.35rem 0 0; font-size: 0.82rem; color: #cbd5f5;">
                        Last Updated: <span id="last-updated">—</span>
                    </p>
                </div>
            </div>

            <div class="hero-image-wrapper">
                <div class="hero-image"></div>
            </div>
        </section>

        <!-- TABBED GLASS PANEL -->
        <section class="glass cards-section">
            <div class="tabs">
                <!-- Radios -->
                <input type="radio" name="tabs" id="tab-pubs" checked>
                <input type="radio" name="tabs" id="tab-edu">
                <input type="radio" name="tabs" id="tab-research">
                <input type="radio" name="tabs" id="tab-prof">
                <input type="radio" name="tabs" id="tab-awards">
                <input type="radio" name="tabs" id="tab-tools">
                <input type="radio" name="tabs" id="tab-hobbies">

                <!-- Tab labels -->
                <div class="tab-labels">
                    <label class="tab-label" for="tab-pubs">Publications</label>
                    <label class="tab-label" for="tab-edu">Academics</label>
                    <label class="tab-label" for="tab-prof">Experiences</label>
                    <label class="tab-label" for="tab-awards">Awards</label>
                    <label class="tab-label" for="tab-tools">References</label>
                    <label class="tab-label" for="tab-research">Research</label>
                    <label class="tab-label" for="tab-hobbies">Interests</label>
                </div>

                <!-- Tab contents -->
                <div class="tab-contents">
                    <!-- These 5 panels are filled from external JSON files -->
                    <div class="tab-panel" id="content-pubs"></div>
                    <div class="tab-panel" id="content-edu"></div>
                    <div class="tab-panel" id="content-prof"></div>
                    <div class="tab-panel" id="content-awards"></div>
                    <div class="tab-panel" id="content-tools"></div>

                    <!-- Research Hub (kept exactly) -->
                    <div class="tab-panel" id="content-research">
                        <h3>Research Hub</h3>
                        <p>
                          Explore research pages and technical analyses centered on β-Ga₂O₃ materials, nanofabrication, epitaxy,<br>  
                          and device-level engineering.
                        </p>
                        
                        <p>
                          It brings together key insights, experimental observations,<br> and evolving research notes developed during my doctoral work. 
                        </p>
                        
                        <p>
                          The research documented here is the result of continued collaboration and productive exchanges with<br>  
                          Professor Anhar Bhuiyan and my research group at the University of Massachusetts Lowell.
                        </p>
                        <div class="btn-row">
                            <a class="btn" href="research/bga2o3/hub-bga2o3.html">Enter Research Hub</a>
                            <a class="btn btn-muted" href="https://sites.uml.edu/anhar_bhuiyan/" target="_blank" rel="noopener">Visit Bhuiyan Research Group</a>
                        </div>
                    </div>

                    <!-- Hobbies & Interests (kept exactly, + Facebook button) -->
                    <div class="tab-panel" id="content-hobbies">
                        <h3>Hobbies & Interests</h3>
                        <p>
                            Beyond research, I enjoy tinkering, building, and exploring ideas that don’t always fit neatly into a paper.
                        </p>
                        <p>
                            When it’s time to take a break from dense PDFs and tiny fonts, this is my little corner for lighter explorations.
                        </p>
                        <p>
                            You'll find small projects, art, and experiments that keep me grounded and curious.
                        </p>
                        <p>
                            Take a short detour and explore more of my creative and spiritual side!
                        </p>

                        <div class="btn-row">
                            <a class="btn" href="hobbies/khans-krafts.html">Visit Khan's Krafts</a>
                            <a class="btn btn-faith" href="islamics/faith-corner.html">Visit The Faith Corner</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <p class="page-credit">
            © <span id="year"></span> Khan’s Portfolio — Powered by GitHub Pages
        </p>

    </main>

</div>

<script>
    document.getElementById("year").textContent = new Date().getFullYear();

    async function updateLastUpdatedFromFile(jsonUrl, targetSpanId) {
        const el = document.getElementById(targetSpanId);
        if (!el) return;

        const formatFullDate = (d) =>
            new Intl.DateTimeFormat("en-US", { year: "numeric", month: "long", day: "numeric" }).format(d);

        try {
            const res = await fetch(jsonUrl, { cache: "no-store" });
            if (!res.ok) throw new Error("fetch failed");
            const data = await res.json();

            const raw =
                data.last_updated ??
                data.lastUpdated ??
                data.last_update ??
                data.lastUpdate ??
                data.updated ??
                data.updated_at ??
                data.updatedAt;

            if (typeof raw === "string" && raw.trim()) {
                const parsed = new Date(raw);
                if (!isNaN(parsed.getTime())) {
                    el.textContent = formatFullDate(parsed);
                    return;
                }
            }

            const fallback = new Date(document.lastModified);
            el.textContent = isNaN(fallback.getTime()) ? "—" : formatFullDate(fallback);
        } catch (e) {
            const fallback = new Date(document.lastModified);
            el.textContent = isNaN(fallback.getTime()) ? "—" : formatFullDate(fallback);
        }
    }

    async function renderTabFromFile(jsonUrl, targetPanelId) {
        const panelEl = document.getElementById(targetPanelId);
        if (!panelEl) return;

        try {
            const res = await fetch(jsonUrl, { cache: "no-store" });
            if (!res.ok) return;
            const data = await res.json();

            const h3 = `<h3>${data.h3 || ""}</h3>`;
            const paras = Array.isArray(data.paragraphs)
                ? data.paragraphs.map(t => `<p>${t}</p>`).join("")
                : "";
            const bullets = Array.isArray(data.bullets) && data.bullets.length
                ? `<ul>${data.bullets.map(li => `<li>${li}</li>`).join("")}</ul>`
                : "";

            panelEl.innerHTML = h3 + paras + bullets;
        } catch (e) {
            // fail silently
        }
    }

    async function renderPublicationsFromFile(jsonUrl, targetPanelId) {
        const panelEl = document.getElementById(targetPanelId);
        if (!panelEl) return;

        const escapeHTML = (str) =>
            String(str ?? "").replace(/[&<>"']/g, (m) => ({
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#39;"
            }[m]));

        try {
            const res = await fetch(jsonUrl, { cache: "no-store" });
            if (!res.ok) return;
            const data = await res.json();

            const title = `<h3>${escapeHTML(data.h3 || "Publications")}</h3>`;
            const intro = data.intro ? `<p class="pub-intro">${escapeHTML(data.intro)}</p>` : "";

            const sections = Array.isArray(data.sections) ? data.sections : [];
            const sectionsHTML = sections
                .filter(sec => sec && sec.enabled !== false)
                .map(sec => {
                    const secTitle = escapeHTML(sec.title || "");
                    const entries = Array.isArray(sec.entries) ? sec.entries : [];

                    const entriesHTML = entries.map((e) => {
                        const pubTitle = escapeHTML(e.title || "");
                        const authors = escapeHTML(e.authors || "");
                        const venue = escapeHTML(e.venue || "");
                        const desc = escapeHTML(e.description || "");
                        const doiText = escapeHTML(e.doi_text || "DOI");
                        const doiUrl = escapeHTML(e.doi_url || "#");

                        return `
                            <div class="pub-entry">
                                <div class="pub-title">${pubTitle}</div>
                                <div class="pub-authors">${authors}</div>
                                <div class="pub-venue">${venue}</div>
                                <div class="pub-desc">${desc}</div>
                                <div class="pub-doi"><a href="${doiUrl}" target="_blank" rel="noopener">${doiText}</a></div>
                            </div>
                            <hr class="pub-divider">
                        `;
                    }).join("");

                    if (!secTitle && !entriesHTML) return "";

                    return `
                        <div class="pub-section">
                            ${secTitle ? `<div class="pub-section-title">${secTitle}</div>` : ""}
                            ${entriesHTML || ""}
                        </div>
                    `;
                })
                .join("");

            panelEl.innerHTML = title + intro + sectionsHTML;
        } catch (e) {
            // fail silently
        }
    }

    async function renderEducationFromFile(jsonUrl, targetPanelId) {
        const panelEl = document.getElementById(targetPanelId);
        if (!panelEl) return;

        const escapeHTML = (str) =>
            String(str ?? "").replace(/[&<>"']/g, (m) => ({
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#39;"
            }[m]));

        try {
            const res = await fetch(jsonUrl, { cache: "no-store" });
            if (!res.ok) return;
            const data = await res.json();

            const title = `<h3>${escapeHTML(data.h3 || "Education")}</h3>`;
            const entries = Array.isArray(data.entries) ? data.entries : [];

            const entriesHTML = entries.map((e) => {
                const degree = escapeHTML(e.degree || "");
                const dates = escapeHTML(e.dates || "");
                const lines = Array.isArray(e.lines) ? e.lines : [];

                return `
                    <div class="edu-entry">
                        <div class="edu-left">
                            <div class="edu-title">${degree}</div>
                            <div class="edu-lines">
                                ${lines.map(l => `${escapeHTML(l)}<br>`).join("")}
                            </div>
                        </div>
                        <div class="edu-right">
                            <div class="edu-dates">${dates}</div>
                        </div>
                    </div>
                    <hr class="edu-divider">
                `;
            }).join("");

            panelEl.innerHTML = title + entriesHTML;
        } catch (e) {
            // fail silently
        }
    }

    async function renderExperiencesFromFile(jsonUrl, targetPanelId) {
        const panelEl = document.getElementById(targetPanelId);
        if (!panelEl) return;

        const escapeHTML = (str) =>
            String(str ?? "").replace(/[&<>"']/g, (m) => ({
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#39;"
            }[m]));

        try {
            const res = await fetch(jsonUrl, { cache: "no-store" });
            if (!res.ok) return;
            const data = await res.json();

            const title = `<h3>${escapeHTML(data.h3 || "Experiences")}</h3>`;
            const sections = Array.isArray(data.sections) ? data.sections : [];

            const sectionsHTML = sections
                .filter(sec => sec && sec.enabled !== false)
                .map(sec => {
                    const secTitle = escapeHTML(sec.title || "");
                    const entries = Array.isArray(sec.entries) ? sec.entries : [];
                    const tool_groups = Array.isArray(sec.tool_groups) ? sec.tool_groups : [];

                    const entriesHTML = entries.map((e) => {
                        const role = escapeHTML(e.role || "");
                        const org = escapeHTML(e.organization || "");
                        const desc = escapeHTML(e.description || "");
                        const dates = escapeHTML(e.dates || "");

                        return `
                            <div class="exp-entry">
                                <div class="exp-left">
                                    <div class="exp-role">${role}</div>
                                    <div class="exp-org">${org}</div>
                                    <div class="exp-desc">${desc}</div>
                                </div>
                                <div class="exp-right">
                                    <div class="exp-dates">${dates}</div>
                                </div>
                            </div>
                            <hr class="exp-divider">
                        `;
                    }).join("");

                    const toolsHTML = tool_groups.map(g => {
                        const gTitle = escapeHTML(g.title || "");
                        const tools = Array.isArray(g.tools) ? g.tools : [];
                        if (!gTitle && !tools.length) return "";
                        return `
                            <div class="exp-subtitle">${gTitle}</div>
                            <ul class="exp-tools">
                                ${tools.map(t => `<li>${escapeHTML(t)}</li>`).join("")}
                            </ul>
                        `;
                    }).join("");

                    if (!secTitle && !entriesHTML && !toolsHTML) return "";

                    return `
                        <div class="exp-section">
                            ${secTitle ? `<div class="exp-section-title">${secTitle}</div>` : ""}
                            ${entriesHTML}
                            ${toolsHTML}
                        </div>
                    `;
                })
                .join("");

            panelEl.innerHTML = title + sectionsHTML;
        } catch (e) {
            // fail silently
        }
    }

    async function renderAwardsFromFile(jsonUrl, targetPanelId) {
        const panelEl = document.getElementById(targetPanelId);
        if (!panelEl) return;

        const escapeHTML = (str) =>
            String(str ?? "").replace(/[&<>"']/g, (m) => ({
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#39;"
            }[m]));

        try {
            const res = await fetch(jsonUrl, { cache: "no-store" });
            if (!res.ok) return;
            const data = await res.json();

            const title = `<h3>${escapeHTML(data.h3 || "Awards")}</h3>`;
            const intro = data.intro ? `<p class="awd-intro">${escapeHTML(data.intro)}</p>` : "";

            const sections = Array.isArray(data.sections) ? data.sections : [];
            const sectionsHTML = sections
                .filter(sec => sec && sec.enabled !== false)
                .map(sec => {
                    const secTitle = escapeHTML(sec.title || "");
                    const entries = Array.isArray(sec.entries) ? sec.entries : [];

                    const entriesHTML = entries.map((e) => {
                        const aTitle = escapeHTML(e.title || "");
                        const aDesc = escapeHTML(e.description || "");

                        return `
                            <div class="awd-entry">
                                <div class="awd-title">${aTitle}</div>
                                <div class="awd-desc">${aDesc}</div>
                            </div>
                            <hr class="awd-divider">
                        `;
                    }).join("");

                    if (!secTitle && !entriesHTML) return "";

                    return `
                        <div class="awd-section">
                            ${secTitle ? `<div class="awd-section-title">${secTitle}</div>` : ""}
                            ${entriesHTML || ""}
                        </div>
                    `;
                })
                .join("");

            panelEl.innerHTML = title + intro + sectionsHTML;
        } catch (e) {
            // fail silently
        }
    }

    async function renderReferencesFromFile(jsonUrl, targetPanelId) {
        const panelEl = document.getElementById(targetPanelId);
        if (!panelEl) return;

        const escapeHTML = (str) =>
            String(str ?? "").replace(/[&<>"']/g, (m) => ({
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#39;"
            }[m]));

        try {
            const res = await fetch(jsonUrl, { cache: "no-store" });
            if (!res.ok) return;
            const data = await res.json();

            const title = `<h3>${escapeHTML(data.h3 || "References")}</h3>`;
            const intro = data.intro ? `<p class="ref-intro">${escapeHTML(data.intro)}</p>` : "";

            const sections = Array.isArray(data.sections) ? data.sections : [];
            const sectionsHTML = sections
                .filter(sec => sec && sec.enabled !== false)
                .map(sec => {
                    const secTitle = escapeHTML(sec.title || "");
                    const entries = Array.isArray(sec.entries) ? sec.entries : [];

                    const entriesHTML = entries.map((e, idx) => {
                        const name = escapeHTML(e.name || "");
                        const role = escapeHTML(e.role_title || "");
                        const dept = escapeHTML(e.department || "");
                        const org = escapeHTML(e.organization || "");
                        const email = escapeHTML(e.email || "");
                        const website = escapeHTML(e.website || "");
                        const relation = escapeHTML(e.relationship || "");

                        const lines = [
                            role,
                            dept,
                            org
                        ].filter(Boolean);

                        const emailLine = email ? `E-mail: <a href="mailto:${email}">${email}</a>` : "";
                        const websiteLine = website ? `Website: <a href="${website}" target="_blank" rel="noopener">${website}</a>` : "";

                        const leftHTML = `
                            <div class="ref-left">
                                <div class="ref-name">${name}</div>
                                <div class="ref-lines">
                                    ${lines.filter(Boolean).map(l => `${l}<br>`).join("")}
                                    ${emailLine ? `${emailLine}<br>` : ""}
                                    ${websiteLine ? `${websiteLine}` : ""}
                                </div>
                            </div>
                        `;

                        const rightHTML = `
                            <div class="ref-right">
                                <div class="ref-relation">${relation}</div>
                            </div>
                        `;

                        const divider = (idx < entries.length - 1) ? `<hr class="ref-divider">` : "";

                        return `<div class="ref-entry">${leftHTML}${rightHTML}</div>${divider}`;
                    }).join("");

                    if (!secTitle && !entriesHTML) return "";

                    return `
                        <div class="ref-section">
                            ${secTitle ? `<div class="ref-section-title">${secTitle}</div>` : ""}
                            ${entriesHTML || ""}
                        </div>
                    `;
                })
                .join("");

            panelEl.innerHTML = title + intro + sectionsHTML;
        } catch (e) {
            // fail silently
        }
    }

    updateLastUpdatedFromFile("tab-publications.json", "last-updated");

    renderPublicationsFromFile("tab-publications.json", "content-pubs");
    renderEducationFromFile("tab-education.json", "content-edu");
    renderExperiencesFromFile("tab-experiences.json", "content-prof");
    renderAwardsFromFile("tab-awards.json", "content-awards");
    renderReferencesFromFile("tab-references.json", "content-tools");
</script>

</body>
</html>
